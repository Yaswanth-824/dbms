<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/schema/spring-security">
<head>
    <meta charset="UTF-8">
    <title>Travel Places</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="/css/path.css">
</head>
<body>
    <div class="container mt-5">
        <h1 class="text-center">Travel Places</h1>
        <div th:each="place : ${data}" class="place-container mb-4 border p-3 rounded shadow-sm bg-light">
            <h2 th:text="${place.title}" class="h4"></h2>
            <p th:text="${place.description}"></p>
            <p>Total Cost: <span th:text="${place.totalCost}"></span></p>
            <p>Number of Days: <span th:text="${place.Days}"></span></p>
            
            <h3>Images:</h3>
            <div class="carousel-container">
                <div class="carousel" id="imageCarousel" th:each="image, iterStat : ${place.images}">
                    <img th:src="@{/uploads/places/{filename}(filename=${image.imgPath})}" 
                         alt="Image not available" 
                         class="${iterStat.index == 0 ? 'active' : ''}" /> <!-- Set first image as active -->
                </div>
            </div>

            <!-- Dropdown Button -->
            <div class="dropdown mt-3">
                <button class="btn btn-primary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                    Options
                </button>
                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                    <a class="dropdown-item" href="#">Option 1</a>
                    <a class="dropdown-item" href="#">Option 2</a>
                    <a class="dropdown-item" href="#">Option 3</a>
                </div>
            </div>

                <h4>Book This Place</h4>
                <form th:action="@{/Booking/place/{placeId}(placeId=${place.placeId})}" method="post">
                    <input type="hidden" th:name="placeId" th:value="${place.placeId}" />
                    <div class="form-group">
                        <label for="status">Booking Status</label>
                        <select id="status" name="status" class="form-control">
                            <option value="confirmed">Confirmed</option>
                            <option value="pending">Pending</option>
                            <option value="canceled">Canceled</option>
                        </select>
                    </div>
                    <button type="submit" class="btn btn-success">Confirm Booking</button>
                </form>
    </div>

    <!-- Bootstrap JS and dependencies -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <!-- Custom JavaScript for automatic sliding -->
    <script>
        const carousel = document.getElementById('imageCarousel');
        const images = carousel.getElementsByTagName('img');
        let index = 0;

        function slideImages() {
            // Remove active class from current image
            images[index].classList.remove('active');

            // Move to the next image
            index = (index + 1) % images.length; // Loop back to first image

            // Add active class to new image
            images[index].classList.add('active');

            // Calculate offset and apply CSS transformation
            const offset = -index * 100;
            carousel.style.transform = `translateX(${offset}%)`;
        }

        // Automatically slide images every 3 seconds
        setInterval(slideImages, 3000);
    </script>

</body>
</html>
